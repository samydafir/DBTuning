\documentclass[11pt]{scrartcl}

\usepackage[top=2cm]{geometry}
%\pagestyle{empty}

\title{
  \textbf{\large Database Tuning -- Assignment 4}\\
  Index Tuning
}

\author{
	A2\\
	\large Baumgartner Dominik, 0920177 \\
	\large Dafir Thomas Samy, 1331483 \\
	\large Sch\"orgnhofer Kevin, 1421082
}

\begin{document}

\maketitle

\noindent
{\it Notes:}
\begin{itemize}\itemsep=0pt
\item Do not forget to run {\tt ANALYZE tablename} after creating or
  changing a table.
\item Use {\tt EXPLAIN ANALYZE} for the query plans that you display in the report.
\end{itemize}


\section{Experimental Setup}

How do send the queries to the database? How do you measure the
execution time for a sequence of queries?

\section{Clustered B$^+$-Tree Index}

\paragraph{Point Query}

Repeat the following query multiple times with different conditions for {\tt pubID}.

{\small
\begin{verbatim}
SELECT * FROM Publ WHERE pubID = ...
\end{verbatim}
}

\noindent
Which conditions did you use?

\smallskip\noindent
Show the runtime results and compute the throughput.

\smallskip\noindent
Query plan (for one of the queries):
{\small
\begin{verbatim}
query plan
\end{verbatim}
}

\paragraph{Multipoint Query -- Low Selectivity}

Repeat the following query multiple times with different conditions for {\tt booktitle}.

{\small
\begin{verbatim}
SELECT * FROM Publ WHERE booktitle = ...
\end{verbatim}
}

\noindent
Which conditions did you use?\\
We used a equality condition where the index matches a given string from the booktitle row of the publ.tsv file, like 'Software Engineering (Workshops)'.

\smallskip\noindent
Show the runtime results and compute the throughput.\\
For the Clustered B$^+$-Tree Index we achieved a runtime from 9366$ms$ to 10196$ms$ with 719 searched values.
This leads to a throughput of 70,5$\frac{queries}{second}$ to 76,8$\frac{queries}{second}$.\\
\newpage
Query plan (for one of the queries):
\begin{verbatim}
EXPLAIN SELECT * FROM publ_cb WHERE booktitle = 'Software Engineering (Workshops)';

 Index Scan using booktitlecb on publ_cb  (cost=0.43..14.60 rows=181 width=112)
   Index Cond: ((booktitle)::text = 'Software Engineering (Workshops)'::text)
(2 rows)
\end{verbatim}

\paragraph{Multipoint Query -- High Selectivity}

Repeat the following query multiple times with different conditions for {\tt year}.

{\small
\begin{verbatim}
SELECT * FROM Publ WHERE year = ...
\end{verbatim}
}

\noindent
Which conditions did you use?

\smallskip\noindent
Show the runtime results and compute the throughput.

\smallskip\noindent
Query plan (for one of the queries):
{\small
\begin{verbatim}
query plan
\end{verbatim}
}

\section{Non-Clustered B$^+$-Tree Index}

\noindent \emph{Note:} Make sure the data is not physically ordered by
the indexed attributes due to the clustering index that you created
before.

\paragraph{Point Query}

Repeat the following query multiple times with different conditions for {\tt pubID}.

{\small
\begin{verbatim}
SELECT * FROM Publ WHERE pubID = ...
\end{verbatim}
}

\noindent
Which conditions did you use?

\smallskip\noindent
Show the runtime results and compute the throughput.

\smallskip\noindent
Query plan (for one of the queries):
{\small
\begin{verbatim}
query plan
\end{verbatim}
}


\paragraph{Multipoint Query -- Low Selectivity}

Repeat the following query multiple times with different conditions for {\tt booktitle}.

{\small
\begin{verbatim}
SELECT * FROM Publ WHERE booktitle = ...
\end{verbatim}
}

\noindent
Which conditions did you use?\\
We used a equality condition where the index matches a given string from the booktitle row of the publ.tsv file, like 'Software Engineering (Workshops)'.

\smallskip\noindent
Show the runtime results and compute the throughput.\\
For the Non-Clustered B$^+$-Tree Index we achieved a runtime from 9916$ms$ to 11347$ms$ with 719 searched values.
This leads to a throughput of 63,4$\frac{queries}{second}$ to 72,5$\frac{queries}{second}$.\\

\smallskip\noindent
Query plan (for one of the queries):
\begin{verbatim}
EXPLAIN SELECT * FROM publ_b WHERE booktitle = 'Software Engineering (Workshops)';

 Index Scan using booktitleb on publ_b  (cost=0.43..577.16 rows=181 width=113)
   Index Cond: ((booktitle)::text = 'Software Engineering (Workshops)'::text)
(2 rows)
\end{verbatim}



\paragraph{Multipoint Query -- High Selectivity}

Repeat the following query multiple times with different conditions for {\tt year}.

{\small
\begin{verbatim}
SELECT * FROM Publ WHERE year = ...
\end{verbatim}
}

\noindent
Which conditions did you use?

\smallskip\noindent
Show the runtime results and compute the throughput.

\smallskip\noindent
Query plan (for one of the queries):
{\small
\begin{verbatim}
query plan
\end{verbatim}
}

\section{Non-Clustered Hash Index}

\noindent \emph{Note:} Make sure the data is not physically ordered by
the indexed attributes due to the clustering index that you created
before.

\paragraph{Point Query}

Repeat the following query multiple times with different conditions for {\tt pubID}.

{\small
\begin{verbatim}
SELECT * FROM Publ WHERE pubID = ...
\end{verbatim}
}

\noindent
Which conditions did you use?

\smallskip\noindent
Show the runtime results and compute the throughput.

\smallskip\noindent
Query plan (for one of the queries):
{\small
\begin{verbatim}
query plan
\end{verbatim}
}


\paragraph{Multipoint Query -- Low Selectivity}

Repeat the following query multiple times with different conditions for {\tt booktitle}.

{\small
\begin{verbatim}
SELECT * FROM Publ WHERE booktitle = ...
\end{verbatim}
}

\noindent
Which conditions did you use?\\
We used a equality condition where the index matches a given string from the booktitle row of the publ.tsv file, like 'Software Engineering (Workshops)'.

\smallskip\noindent
Show the runtime results and compute the throughput.\\
For the Non-Clustered Hash Index we achieved a runtime from 12447$ms$ to 11347$ms$ with 719 searched values.
This leads to a throughput of 57,8$\frac{queries}{second}$ to 76,9$\frac{queries}{second}$.\\

\smallskip\noindent
Query plan (for one of the queries):
\begin{verbatim}
EXPLAIN SELECT * FROM publ_h WHERE booktitle = 'Software Engineering (Workshops)';

 Bitmap Heap Scan on publ_h  (cost=5.37..668.34 rows=177 width=112)
   Recheck Cond: ((booktitle)::text = 'Software Engineering (Workshops)'::text)
   ->  Bitmap Index Scan on booktitleh  (cost=0.00..5.33 rows=177 width=0)
          Index Cond: ((booktitle)::text = 'Software Engineering (Workshops)'::text)
(4 rows)
\end{verbatim}


\paragraph{Multipoint Query -- High Selectivity}

Repeat the following query multiple times with different conditions for {\tt year}.

{\small
\begin{verbatim}
SELECT * FROM Publ WHERE year = ...
\end{verbatim}
}

\noindent
Which conditions did you use?

\smallskip\noindent
Show the runtime results and compute the throughput.

\smallskip\noindent
Query plan (for one of the queries):
{\small
\begin{verbatim}
query plan
\end{verbatim}
}


\section{Table Scan}

\noindent \emph{Note:} Make sure the data is not physically ordered by
the indexed attributes due to the clustering index that you created
before.

\paragraph{Point Query}

Repeat the following query multiple times with different conditions for {\tt pubID}.

{\small
\begin{verbatim}
SELECT * FROM Publ WHERE pubID = ...
\end{verbatim}
}

\noindent
Which conditions did you use?

\smallskip\noindent
Show the runtime results and compute the throughput.

\smallskip\noindent
Query plan (for one of the queries):
{\small
\begin{verbatim}
query plan
\end{verbatim}
}


\paragraph{Multipoint Query -- Low Selectivity}

Repeat the following query multiple times with different conditions for {\tt booktitle}.

{\small
\begin{verbatim}
SELECT * FROM Publ WHERE booktitle = ...
\end{verbatim}
}

\noindent
Which conditions did you use?\\
We used a equality condition where the index matches a given string from the booktitle row of the publ.tsv file, like 'Software Engineering (Workshops)'.

\smallskip\noindent
Show the runtime results and compute the throughput.\\
For the Table Scan we achieved a runtime from 197998$ms$ to 201809$ms$ with 719 searched values.
This leads to a throughput of 3,6$\frac{queries}{second}$.\\

\smallskip\noindent
Query plan (for one of the queries):
\begin{verbatim}
EXPLAIN SELECT * FROM publ_s WHERE booktitle = 'Software Engineering (Workshops)';

 Seq Scan on publ_s  (cost=0.00..37843.18 rows=179 width=112)
   Filter: ((booktitle)::text = 'Software Engineering (Workshops)'::text)
(2 rows)
\end{verbatim}


\paragraph{Multipoint Query -- High Selectivity}

Repeat the following query multiple times with different conditions for {\tt year}.

{\small
\begin{verbatim}
SELECT * FROM Publ WHERE year = ...
\end{verbatim}
}

\noindent
Which conditions did you use?

\smallskip\noindent
Show the runtime results and compute the throughput.

\smallskip\noindent
Query plan (for one of the queries):
{\small
\begin{verbatim}
query plan
\end{verbatim}
}

\section{Discussion}

Give the throughput of the query types and index types in queries/second.
\begin{center}
  \begin{tabular}{c|c|c|c|c}
    & clustered & non-clust.\ B$^+$-tree & non-clust.\ hash & table scan \\
    \hline
    point ({\tt pubID}) & & & \\
    \hline
    multipoint ({\tt booktitle}) & 73,14 & 69,37 & 69,73 & 3,6\\
    \hline
    multipoint  ({\tt year}) & & & \\  
  \end{tabular}
\end{center}

\medskip

Discuss the runtime results for the different index types and the
table scan. Are the results expected? Why / why not?


\bigskip

\noindent Time in hours per person: {\bf XXX}

\bigskip

\begin{center}
  \begin{tabular}{c}
    \hline
    {\bf Important:} Reference your information sources!
    \\\hline
  \end{tabular}
\end{center}

\end{document}
